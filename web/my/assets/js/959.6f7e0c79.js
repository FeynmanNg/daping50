(window.webpackJsonp=window.webpackJsonp||[]).push([[959],{2551:function(e,t,r){"use strict";r.r(t);var i,n=r(296),a=(r(67),r(301),r(295)),o=r(425),s=r(490),u=r(440),c=r(543),h=r(470),f=r(460),l=r(489),d=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function p(e,t){for(var r=d.length,i=0;i<r;++i)try{var n=e.getContext(d[i],t);if(n)return n}catch(e){}return null}var m=r(428),_=35044;function g(e){switch(e){case 34962:return Float32Array;case 34963:return Uint32Array;default:return Float32Array}}var v=function(){function e(e,t){this.array=null,this.type=e,Object(m.a)(34962===e||34963===e,62),this.usage=void 0!==t?t:_}return e.prototype.ofSize=function(e){this.array=new(g(this.type))(e)},e.prototype.fromArray=function(e){this.array=g(this.type).from(e)},e.prototype.fromArrayBuffer=function(e){this.array=new(g(this.type))(e)},e.prototype.getType=function(){return this.type},e.prototype.getArray=function(){return this.array},e.prototype.getUsage=function(){return this.usage},e.prototype.getSize=function(){return this.array?this.array.length:0},e}(),y=r(443),b=r(904),E="webglcontextlost",T="webglcontextrestored",x=r(648);function w(e,t){return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}var R,S=function(){function e(e){this.gl_=e.webGlContext;var t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),t.compileShader(r);var i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n"),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(r){this.uniforms_.push({value:e.uniforms[r],location:t.getUniformLocation(this.renderTargetProgram_,r)})}.bind(this))}return e.prototype.getGL=function(){return this.gl_},e.prototype.init=function(e){var t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;var i=t.RGBA,n=t.RGBA,a=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,0,i,r[0],r[1],0,n,a,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},e.prototype.apply=function(e,t){var r=this.getGL(),i=e.size;r.bindFramebuffer(r.FRAMEBUFFER,t?t.getFrameBuffer():null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.useProgram(this.renderTargetProgram_),r.enableVertexAttribArray(this.renderTargetAttribLocation_),r.vertexAttribPointer(this.renderTargetAttribLocation_,2,r.FLOAT,!1,0,0),r.uniform2f(this.renderTargetUniformLocation_,i[0],i[1]),r.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(e),r.drawArrays(r.TRIANGLES,0,6)},e.prototype.getFrameBuffer=function(){return this.frameBuffer_},e.prototype.applyUniforms=function(e){var t,r=this.getGL(),i=1;this.uniforms_.forEach((function(n){if((t="function"==typeof n.value?n.value(e):n.value)instanceof HTMLCanvasElement||t instanceof ImageData)n.texture||(n.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+i]),r.bindTexture(r.TEXTURE_2D,n.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),t instanceof ImageData?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,t.width,t.height,0,r.UNSIGNED_BYTE,new Uint8Array(t.data)):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.uniform1i(n.location,i++);else if(Array.isArray(t))switch(t.length){case 2:return void r.uniform2f(n.location,t[0],t[1]);case 3:return void r.uniform3f(n.location,t[0],t[1],t[2]);case 4:return void r.uniform4f(n.location,t[0],t[1],t[2],t[3]);default:return}else"number"==typeof t&&r.uniform1f(n.location,t)}))},e}(),A=r(413),O=(R=function(e,t){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}R(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),C="u_projectionMatrix",L="u_offsetScaleMatrix",P="u_offsetRotateMatrix",j="u_time",F="u_zoom",I="u_resolution",G={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};function M(e){switch(e){case G.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case G.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case G.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case G.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var U=function(e){function t(t){var r=e.call(this)||this,n=t||{};r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvas_=document.createElement("canvas"),r.canvas_.style.position="absolute",r.canvas_.style.left="0",r.gl_=p(r.canvas_);var a=r.getGL();if(r.bufferCache_={},r.currentProgram_=null,Object(m.a)(Object(A.f)(function(){if(!i){var e=p(document.createElement("canvas"));e&&(i=e.getSupportedExtensions())}return i}(),"OES_element_index_uint"),63),a.getExtension("OES_element_index_uint"),r.canvas_.addEventListener(E,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(T,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=Object(x.c)(),r.offsetScaleMatrix_=Object(x.c)(),r.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],n.uniforms)for(var o in n.uniforms)r.uniforms_.push({name:o,value:n.uniforms[o]});return r.postProcessPasses_=n.postProcesses?n.postProcesses.map((function(e){return new S({webGlContext:a,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})})):[new S({webGlContext:a})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return O(t,e),t.prototype.bindBuffer=function(e){var t=this.getGL(),r=Object(y.c)(e),i=this.bufferCache_[r];i||(i={buffer:e,webGlBuffer:t.createBuffer()},this.bufferCache_[r]=i);t.bindBuffer(e.getType(),i.webGlBuffer)},t.prototype.flushBufferData=function(e){var t=this.getGL();this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())},t.prototype.deleteBuffer=function(e){var t=this.getGL(),r=Object(y.c)(e),i=this.bufferCache_[r];t.isContextLost()||t.deleteBuffer(i.buffer),delete this.bufferCache_[r]},t.prototype.disposeInternal=function(){this.canvas_.removeEventListener(E,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(T,this.boundHandleWebGLContextRestored_)},t.prototype.prepareDraw=function(e){var t=this.getGL(),r=this.getCanvas(),i=e.size,n=e.pixelRatio;r.width=i[0]*n,r.height=i[1]*n,r.style.width=i[0]+"px",r.style.height=i[1]+"px",t.useProgram(this.currentProgram_);for(var a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(e);t.bindTexture(t.TEXTURE_2D,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.prepareDrawToRenderTarget=function(e,t,r){var i=this.getGL(),n=t.getSize();i.bindFramebuffer(i.FRAMEBUFFER,t.getFramebuffer()),i.viewport(0,0,n[0],n[1]),i.bindTexture(i.TEXTURE_2D,t.getTexture()),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,r?i.ZERO:i.ONE_MINUS_SRC_ALPHA),i.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.drawElements=function(e,t){var r=this.getGL(),i=r.UNSIGNED_INT,n=t-e,a=4*e;r.drawElements(r.TRIANGLES,n,i,a)},t.prototype.finalizeDraw=function(e){for(var t=0;t<this.postProcessPasses_.length;t++)this.postProcessPasses_[t].apply(e,this.postProcessPasses_[t+1]||null)},t.prototype.getCanvas=function(){return this.canvas_},t.prototype.getGL=function(){return this.gl_},t.prototype.applyFrameState=function(e){var t=e.size,r=e.viewState.rotation,i=Object(x.g)(this.offsetScaleMatrix_);Object(x.i)(i,2/t[0],2/t[1]);var n=Object(x.g)(this.offsetRotateMatrix_);0!==r&&Object(x.h)(n,-r),this.setUniformMatrixValue(L,w(this.tmpMat4_,i)),this.setUniformMatrixValue(P,w(this.tmpMat4_,n)),this.setUniformFloatValue(j,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(F,e.viewState.zoom),this.setUniformFloatValue(I,e.viewState.resolution)},t.prototype.applyUniforms=function(e){var t,r=this.getGL(),i=0;this.uniforms_.forEach(function(n){if((t="function"==typeof n.value?n.value(e):n.value)instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof ImageData)n.texture||(n.prevValue=void 0,n.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+i]),r.bindTexture(r.TEXTURE_2D,n.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),(!(t instanceof HTMLImageElement)||t.complete)&&n.prevValue!==t&&(n.prevValue=t,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)),r.uniform1i(this.getUniformLocation(n.name),i++);else if(Array.isArray(t)&&6===t.length)this.setUniformMatrixValue(n.name,w(this.tmpMat4_,t));else if(Array.isArray(t)&&t.length<=4)switch(t.length){case 2:return void r.uniform2f(this.getUniformLocation(n.name),t[0],t[1]);case 3:return void r.uniform3f(this.getUniformLocation(n.name),t[0],t[1],t[2]);case 4:return void r.uniform4f(this.getUniformLocation(n.name),t[0],t[1],t[2],t[3]);default:return}else"number"==typeof t&&r.uniform1f(this.getUniformLocation(n.name),t)}.bind(this))},t.prototype.useProgram=function(e){return e!=this.currentProgram_&&(this.getGL().useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},!0)},t.prototype.compileShader=function(e,t){var r=this.getGL(),i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i},t.prototype.getProgram=function(e,t){var r=this.getGL(),i=this.compileShader(e,r.FRAGMENT_SHADER),n=this.compileShader(t,r.VERTEX_SHADER);this.shaderCompileErrors_=null,r.getShaderInfoLog(i)&&(this.shaderCompileErrors_="Fragment shader compilation failed:\n"+r.getShaderInfoLog(i)),r.getShaderInfoLog(n)&&(this.shaderCompileErrors_=(this.shaderCompileErrors_||"")+"Vertex shader compilation failed:\n"+r.getShaderInfoLog(n));var a=r.createProgram();return r.attachShader(a,i),r.attachShader(a,n),r.linkProgram(a),a},t.prototype.getShaderCompileErrors=function(){return this.shaderCompileErrors_},t.prototype.getUniformLocation=function(e){return void 0===this.uniformLocations_[e]&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]},t.prototype.getAttributeLocation=function(e){return void 0===this.attribLocations_[e]&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]},t.prototype.makeProjectionTransform=function(e,t){var r=e.size,i=e.viewState.rotation,n=e.viewState.resolution,a=e.viewState.center;return Object(x.g)(t),Object(x.b)(t,0,0,2/(n*r[0]),2/(n*r[1]),-i,-a[0],-a[1]),t},t.prototype.setUniformFloatValue=function(e,t){this.getGL().uniform1f(this.getUniformLocation(e),t)},t.prototype.setUniformMatrixValue=function(e,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,t)},t.prototype.enableAttributeArray_=function(e,t,r,i,n){var a=this.getAttributeLocation(e);a<0||(this.getGL().enableVertexAttribArray(a),this.getGL().vertexAttribPointer(a,t,r,!1,i,n))},t.prototype.enableAttributes=function(e){for(var t=function(e){for(var t=0,r=0;r<e.length;r++){var i=e[r];t+=i.size*M(i.type)}return t}(e),r=0,i=0;i<e.length;i++){var n=e[i];this.enableAttributeArray_(n.name,n.size,n.type||5126,t,r),r+=n.size*M(n.type)}},t.prototype.handleWebGLContextLost=function(){Object(l.b)(this.bufferCache_),this.currentProgram_=null},t.prototype.handleWebGLContextRestored=function(){},t.prototype.createTexture=function(e,t,r){var i=this.getGL(),n=r||i.createTexture(),a=i.RGBA,o=i.RGBA,s=i.UNSIGNED_BYTE;return i.bindTexture(i.TEXTURE_2D,n),t?i.texImage2D(i.TEXTURE_2D,0,a,o,s,t):i.texImage2D(i.TEXTURE_2D,0,a,e[0],e[1],0,o,s,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),n},t}(b.a),D=r(411),B=r(1118),z=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),N="GENERATE_BUFFERS",V=function(e){function t(t,r){var i=e.call(this,t)||this,n=r||{};return i.helper=new U({postProcesses:n.postProcesses,uniforms:n.uniforms}),i}return z(t,e),t.prototype.disposeInternal=function(){this.helper.dispose(),e.prototype.disposeInternal.call(this)},t.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},t}(B.a);function X(e,t){var r=t||[];return r[0]=Math.floor(e/256/256/256)/255,r[1]=Math.floor(e/256/256)%256/255,r[2]=Math.floor(e/256)%256/255,r[3]=e%256/255,r}var k=V,H=r(905),W=r(325),Y=new Blob(['var e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n="GENERATE_BUFFERS",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};'],{type:"application/javascript"}),Z=URL.createObjectURL(Y);var $=new Uint8Array(4),q=function(){function e(e,t){this.helper_=e;var r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return e.prototype.setSize=function(e){Object(A.b)(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())},e.prototype.getSize=function(){return this.size_},e.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},e.prototype.readAll=function(){if(this.dataCacheDirty_){var e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},e.prototype.readPixel=function(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return $[0]=0,$[1]=0,$[2]=0,$[3]=0,$;this.readAll();var r=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return $[0]=this.data_[4*r],$[1]=this.data_[4*r+1],$[2]=this.data_[4*r+2],$[3]=this.data_[4*r+3],$},e.prototype.getTexture=function(){return this.texture_},e.prototype.getFramebuffer=function(){return this.framebuffer_},e.prototype.updateSize_=function(){var e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(e[0]*e[1]*4)},e}(),K=r(1119),J=r(433),Q=r(836),ee=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),te=function(e){function t(t,r){var i=this,n=r.uniforms||{},a=Object(x.c)();n[C]=a,(i=e.call(this,t,{uniforms:n,postProcesses:r.postProcesses})||this).sourceRevision_=-1,i.verticesBuffer_=new v(34962,35048),i.hitVerticesBuffer_=new v(34962,35048),i.indicesBuffer_=new v(34963,35048),i.program_=i.helper.getProgram(r.fragmentShader,r.vertexShader),i.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),i.hitProgram_=i.hitDetectionEnabled_&&i.helper.getProgram(r.hitFragmentShader,r.hitVertexShader);var o=r.attributes?r.attributes.map((function(e){return{name:"a_"+e.name,size:1,type:G.FLOAT}})):[];i.attributes=[{name:"a_position",size:2,type:G.FLOAT},{name:"a_index",size:1,type:G.FLOAT}].concat(o),i.hitDetectionAttributes=[{name:"a_position",size:2,type:G.FLOAT},{name:"a_index",size:1,type:G.FLOAT},{name:"a_hitColor",size:4,type:G.FLOAT},{name:"a_featureUid",size:1,type:G.FLOAT}].concat(o),i.customAttributes=r.attributes?r.attributes:[],i.previousExtent_=Object(W.j)(),i.currentTransform_=a,i.renderTransform_=Object(x.c)(),i.invertRenderTransform_=Object(x.c)(),i.renderInstructions_=new Float32Array(0),i.hitRenderInstructions_=new Float32Array(0),i.hitRenderTarget_=i.hitDetectionEnabled_&&new q(i.helper),i.worker_=new Worker(Z),i.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===N){var r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,Object(x.d)(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):this.renderInstructions_=new Float32Array(e.data.renderInstructions),this.getLayer().changed()}}.bind(i)),i.featureCache_={},i.featureCount_=0;var s=i.getLayer().getSource();return i.sourceListenKeys_=[Object(J.a)(s,Q.a.ADDFEATURE,i.handleSourceFeatureAdded_,i),Object(J.a)(s,Q.a.CHANGEFEATURE,i.handleSourceFeatureChanged_,i),Object(J.a)(s,Q.a.REMOVEFEATURE,i.handleSourceFeatureDelete_,i),Object(J.a)(s,Q.a.CLEAR,i.handleSourceFeatureClear_,i)],s.forEachFeature(function(e){this.featureCache_[Object(y.c)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(i)),i}return ee(t,e),t.prototype.handleSourceFeatureAdded_=function(e){var t=e.feature;this.featureCache_[Object(y.c)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(e){var t=e.feature;this.featureCache_[Object(y.c)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(e){var t=e.feature;delete this.featureCache_[Object(y.c)(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(e){var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t),this.helper.finalizeDraw(e);var r=this.helper.getCanvas(),i=e.layerStatesArray[e.layerIndex].opacity;return i!==parseFloat(r.style.opacity)&&(r.style.opacity=i),this.hitDetectionEnabled_&&(this.renderHitDetection(e),this.hitRenderTarget_.clearCachedData()),r},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource(),i=e.viewState,n=!e.viewHints[H.a.ANIMATING]&&!e.viewHints[H.a.INTERACTING],a=!Object(W.p)(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),n&&(a||o)){var s=i.projection,u=i.resolution,c=t instanceof K.a?t.getRenderBuffer():0,h=Object(W.c)(e.extent,c*u);r.loadFeatures(h,u,s),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.makeProjectionTransform(e,this.currentTransform_),Object(x.f)(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(e){var t=Object(x.c)();this.helper.makeProjectionTransform(e,t);var r,i,n=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===n||(this.renderInstructions_=new Float32Array(n)),this.hitDetectionEnabled_){var a=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===a||(this.hitRenderInstructions_=new Float32Array(a))}var o,s=[],u=[],c=0,h=0;for(var f in this.featureCache_)if((i=(r=this.featureCache_[f]).geometry)&&i.getType()===D.a.POINT){s[0]=i.getFlatCoordinates()[0],s[1]=i.getFlatCoordinates()[1],Object(x.a)(t,s),o=X(h+6,u),this.renderInstructions_[c++]=s[0],this.renderInstructions_[c++]=s[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=s[0],this.hitRenderInstructions_[h++]=s[1],this.hitRenderInstructions_[h++]=o[0],this.hitRenderInstructions_[h++]=o[1],this.hitRenderInstructions_[h++]=o[2],this.hitRenderInstructions_[h++]=o[3],this.hitRenderInstructions_[h++]=Number(f));for(var l=void 0,d=0;d<this.customAttributes.length;d++)l=this.customAttributes[d].callback(r.feature,r.properties),this.renderInstructions_[c++]=l,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=l)}var p={type:N,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(p.projectionTransform=t,this.worker_.postMessage(p,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var m={type:N,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};m.projectionTransform=t,m.hitDetection=!0,this.worker_.postMessage(m,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,n){if(Object(m.a)(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var a=Object(x.a)(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),s=function(e){var t=0;return t+=Math.round(256*e[0]*256*256*255),t+=Math.round(256*e[1]*256*255),t+=Math.round(256*e[2]*255),t+=Math.round(255*e[3])}([o[0]/255,o[1]/255,o[2]/255,o[3]/255]),u=this.hitRenderInstructions_[s],c=Math.floor(u).toString(),h=this.getLayer().getSource().getFeatureByUid(c);return h?i(h,this.getLayer()):void 0}},t.prototype.renderHitDetection=function(e){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(e){Object(J.c)(e)})),this.sourceListenKeys_=null,e.prototype.disposeInternal.call(this)},t}(k),re=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ie="blur",ne="gradient",ae="radius",oe=["#00f","#0ff","#0f0","#ff0","#f00"];var se=function(e){function t(t){var r=this,i=t||{},n=Object(l.a)({},i);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,(r=e.call(this,n)||this).gradient_=null,r.addEventListener(Object(u.b)(ne),r.handleGradientChanged_),r.setGradient(i.gradient?i.gradient:oe),r.setBlur(void 0!==i.blur?i.blur:15),r.setRadius(void 0!==i.radius?i.radius:8);var a=i.weight?i.weight:"weight";return r.weightFunction_="string"==typeof a?function(e){return e.get(a)}:a,r.setRenderOrder(null),r}return re(t,e),t.prototype.getBlur=function(){return this.get(ie)},t.prototype.getGradient=function(){return this.get(ne)},t.prototype.getRadius=function(){return this.get(ae)},t.prototype.handleGradientChanged_=function(){this.gradient_=function(e){for(var t=Object(c.a)(1,256),r=t.createLinearGradient(0,0,1,256),i=1/(e.length-1),n=0,a=e.length;n<a;++n)r.addColorStop(n*i,e[n]);return t.fillStyle=r,t.fillRect(0,0,1,256),t.canvas}(this.getGradient())},t.prototype.setBlur=function(e){this.set(ie,e)},t.prototype.setGradient=function(e){this.set(ne,e)},t.prototype.setRadius=function(e){this.set(ae,e)},t.prototype.createRenderer=function(){return new te(this,{attributes:[{name:"weight",callback:function(e){var t=this.weightFunction_(e);return void 0!==t?Object(f.a)(t,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(ae)+this.get(ie))}.bind(this),u_blurSlope:function(){return this.get(ae)/Math.max(1,this.get(ie))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this)}}]})},t}(h.a),ue=r(464),ce={name:"MyMapHeat",inject:["myMap"],render:function(){return null},props:{data:{type:Array,default:function(){return[]}},keyMap:{type:Object,default:function(){return{coordinate:"coordinate",weight:"weight"}}},opacity:{type:Number,default:1},visible:{type:Boolean,default:!0},zIndex:Number,minResolution:Number,maxResolution:Number,minZoom:Number,maxZoom:Number,gradient:{type:Array,default:function(){return["#00f","#0ff","#0f0","#ff0","#f00"]}},radius:{type:Number,default:8},blur:{type:Number,default:15},weight:{type:Function}},watch:{visible:function(e){e?this.show():this.hide()}},methods:{createFeatures:function(){var e=this,t=this.keyMap.coordinate;return this.data.map((function(r){var i=new s.a(r[t]);return new o.a({geometry:i,data:r,__vm__:e})}))},draw:function(){var e=this,t=this.keyMap.weight,r=this.createFeatures(),i=new ue.a({features:r}),n=this.weight?function(t){return e.weight(t.get("data"),t)}:function(e){var r=e.get("data")[t];return void 0===r?1:r};this.heatmap=new se(Object(a.a)(Object(a.a)({},this.$props),{},{source:i,weight:n})),this.myMap.map.addLayer(this.heatmap)},modify:function(){this.heatmap&&(this.myMap.map.removeLayer(this.heatmap),this.draw())},show:function(){this.heatmap&&this.heatmap.setVisible(!0)},hide:function(){this.heatmap&&this.heatmap.setVisible(!1)}},created:function(){this.myMap.mapReady(this.draw)},beforeDestroy:function(){this.heatmap&&this.myMap.map.removeLayer(this.heatmap)}},he=Object(n.a)(ce),fe=r(400),le=r(69),de=r(0),pe={data:function(){return{center:[120,30],data:null}},methods:{mockData:function(){for(var e=Object(le.a)(this.center,2),t=e[0],r=e[1],i=[],n=0;n<1e3;n++)i.push({coordinate:[t+Math.random()-Math.random(),r+Math.random()-Math.random()]});return i}},created:function(){var e=this;setTimeout((function(){e.data=e.mockData()}),0)}};de.default.use(fe.a),de.default.use(he);var me=pe,_e=r(39),ge=Object(_e.a)(me,(function(){var e=this.$createElement,t=this._self._c||e;return t("my-map",{attrs:{center:this.center,adapter:"Amap"}},[this.data?t("my-map-heat",{attrs:{data:this.data}}):this._e()],1)}),[],!1,null,null,null);t.default=ge.exports},296:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r(65),"My".toLowerCase();function i(e){return e.install=function(t){return"undefined"!=typeof window&&r(307).default(e),t.component(e.name,e)},e}},298:function(e,t,r){"use strict";r(310);var i={version:"4.0.1",debug:!1,appName:null,routePrefix:null,router:{mode:"hash",base:"/"},autoRoutes:!0,vuex:{strict:!1},keys:{code:"code",data:"data",message:"msg",total:"total",list:"list",page:"page",limit:"limit",pages:"pages"},statusCode:{success:0,notLogin:401,authorize:403,error:500},axios:{headers:{"Content-Type":"application/json;charset=UTF-8"},timeout:0,withCredentials:!0,responseType:"json",maxContentLength:-1},svg:{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},access:{},mock:{timeout:"50-200"},scale:{width:1920,height:1080,disabled:!0,lock:!0},analysis:!1,microApp:{prefetch:!1,singular:!0,sandbox:!0}};t.a=i},307:function(e,t,r){"use strict";r.r(t);r(160),r(65);var i=r(298),n=!1,a=[],o=null;i.a.analysis&&function(){if(!n){var e="c4e5f73318b5cb0c389e3d9a05f831cc",t=window._hmt;if(!t||t&&t.id!==e){var r=document.createElement("script");r.src="https://hm.baidu.com/hm.js?".concat(e);var i=document.getElementsByTagName("script")[0];i&&i.parentNode.insertBefore(r,i)}n=!0}}(),t.default=function(e){var t;i.a.analysis&&(t=e.name,a.push(t),clearTimeout(o),o=setTimeout((function(){if(window._hmt&&t){var e=window.location.host,r=window.location.href;window._hmt.push(["_trackEvent",e,a.join(","),i.a.version,r]),a=[]}}),3e3))}},370:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return c}));r(91),r(160),r(65),r(438),r(40),r(94),r(412),r(68),r(442),r(367);var i=r(436),n=r.n(i),a=/^(http|https):\/\/[\w.:]*\//;function o(e,t,r){var i,n={};e=(e||location.search).replace(/^[^]*\?/,""),t=t||"&",r=r||"=";for(var a=new RegExp("(?:^|\\"+t+")([^\\"+r+"\\"+t+"]+)(?:\\"+r+"([^\\"+t+"]*))?","g");null!==(i=a.exec(e));)i[1]!==e&&(n[decodeURIComponent(i[1])]=decodeURIComponent(i[2]||""));return n}function s(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push([r,encodeURIComponent(e[r])].join("="));return t.join("&")}function u(e){var t=e.match(a);return t?t[0]:""}function c(e,t){var r=[],i=u(e),a=n()(e.replace(i,""),r).exec(t.split("?")[0].replace(i,"")),o={};return a&&a.length>0&&r.forEach((function(e,t){o[e.name]=a[t+1]})),o}},396:function(e,t,r){"use strict";r.d(t,"a",(function(){return Q}));r(162),r(67);var i=r(295),n=r(41),a=r(397),o=r(482),s=r(484),u=r(395),c=r(488),h=r(478),f=r(344),l=r(481),d=(r(160),r(65),r(7),r(94),r(23)),p=r(47),m=r(113),_=r(114),g=r(110),v=r(111),y=r(469),b=r(475),E="METER",T="KILOMETER",x="DEGREE",w="INCH",R="FOOT",S="ISERVER";function A(e,t,r){var i=e*t*(1/.0254)*function(e){var t;if(e===E)t=1;else if(e===x)t=2*Math.PI*6378137/360;else if(e===T)t=.001;else if(e===w)t=1/.025399999918;else{if(e!==R)return t;t=.3048}return t}(r);return i=1/i}function O(e,t,r){var i=e*t*(1/.0254)*this.getMeterPerMapUnit(r);return i=1/i}var C=function(e){Object(g.a)(r,e);var t=Object(v.a)(r);function r(e){var i;if(Object(d.a)(this,r),void 0===(e=e||{}).url)return Object(m.a)(i);e.format=e.format?e.format:"png";var n=e.url+"/tileImage."+e.format+"?";e.serverType=e.serverType||S,i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,logo:e.logo,opaque:e.opaque,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:e.state,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:function(t,i,n){a.tileGrid||(a.extent?(a.tileGrid=r.createTileGrid(e.extent),a.resolutions&&(a.tileGrid.resolutions=a.resolutions)):("EPSG:3857"===n.getCode()&&(a.tileGrid=r.createTileGrid([-20037508.3427892,-20037508.3427892,20037508.3427892,20037508.3427892]),a.extent=[-20037508.3427892,-20037508.3427892,20037508.3427892,20037508.3427892]),"EPSG:4326"===n.getCode()&&(a.tileGrid=r.createTileGrid([-180,-90,180,90]),a.extent=[-180,-90,180,90])));a.origin=a.tileGrid.getOrigin(0);var o=t[0],u=t[1],c=-t[2]-1,h=a.tileGrid.getResolution(o),f=n.getUnits();"degrees"===f&&(f=x);"m"===f&&(f=E);var l=A(h,96,f),d=Object(y.c)(a.tileGrid.getTileSize(o,a.tmpSize)),p=s.call(a)+encodeURI("&x="+u+"&y="+c+"&width="+d[0]+"&height="+d[1]+"&scale="+l);a.tileProxy&&(p=a.tileProxy+encodeURIComponent(p));a.cacheEnabled||(p+="&_t="+(new Date).getTime());return p},url:e.url,urls:e.urls,wrapX:void 0!==e.wrapX&&e.wrapX,cacheEnabled:e.cacheEnabled,layersID:e.layersID}),e.tileProxy&&(i.tileProxy=e.tileProxy),i.options=e,i._url=e.url,i.tileSetsIndex=-1,i.tempIndex=-1;var a=Object(_.a)(i);function o(){var t={};return t.redirect=void 0!==e.redirect&&e.redirect,t.transparent=void 0===e.transparent||e.transparent,t.cacheEnabled=!(!1===e.cacheEnabled),this.cacheEnabled=t.cacheEnabled,t._cache=t.cacheEnabled,this.origin&&(t.origin=JSON.stringify({x:this.origin[0],y:this.origin[1]})),e.prjCoordSys&&(t.prjCoordSys=JSON.stringify(e.prjCoordSys)),e.layersID&&(t.layersID=e.layersID.toString()),e.overlapDisplayed?t.overlapDisplayed=!0:(t.overlapDisplayed=!1,e.overlapDisplayedOptions&&(t.overlapDisplayedOptions=this.overlapDisplayedOptions.toString())),e.cacheEnabled&&e.tileversion&&(t.tileversion=e.tileversion.toString()),t}function s(){return this._paramsChanged&&(this._layerUrl=u.call(this),this._paramsChanged=!1),this._layerUrl||u.call(this)}function u(){return this._layerUrl=n+encodeURI(c.call(this)),this._layerUrl}function c(){this.requestParams=this.requestParams||o.call(this);var e=[];for(var t in this.requestParams)e.push(t+"="+this.requestParams[t]);return e.join("&")}return i}return Object(p.a)(r,[{key:"setTileSetsInfo",value:function(e){this.tileSets=e,Array.isArray(this.tileSets)&&(this.tileSets=e[0]),this.tileSets&&(this.dispatchEvent({type:"tilesetsinfoloaded",value:{tileVersions:this.tileSets.tileVersions}}),this.changeTilesVersion())}},{key:"lastTilesVersion",value:function(){this.tempIndex=this.tileSetsIndex-1,this.changeTilesVersion()}},{key:"nextTilesVersion",value:function(){this.tempIndex=this.tileSetsIndex+1,this.changeTilesVersion()}},{key:"changeTilesVersion",value:function(){var e=this;if(null!=e.tileSets&&!(e.tempIndex===e.tileSetsIndex||this.tempIndex<0)){var t=e.tileSets.tileVersions;if(t&&e.tempIndex<t.length&&e.tempIndex>=0){var r=t[e.tempIndex].name;e.mergeTileVersionParam(r)&&(e.tileSetsIndex=e.tempIndex,e.dispatchEvent({type:"tileversionschanged",value:{tileVersion:t[e.tempIndex]}}))}}}},{key:"updateCurrentTileSetsIndex",value:function(e){this.tempIndex=e}},{key:"mergeTileVersionParam",value:function(e){return!!e&&(this.requestParams.tileversion=e,this._paramsChanged=!0,this.refresh(),!0)}}],[{key:"optionsFromMapJSON",value:function(e,t){var r={};r.url=e,r.crossOrigin="anonymous";var i=[t.bounds.left,t.bounds.bottom,t.bounds.right,t.bounds.top],n=function(){var e,r=i[2]-i[0],n=i[3]-i[1],a=r>=n?r:n;e=a===r?a/t.viewer.width:a/t.viewer.height;var o=[],s=E;t.coordUnit===x&&(s=x);if(t.visibleScalesEnabled&&t.visibleScales&&t.visibleScales.length>0)for(var u=0;u<t.visibleScales.length;u++)o.push(O(t.visibleScales[u],96,s));else for(var c=0;c<17;c++)o.push(e/Math.pow(2,c));return o.sort((function(e,t){return t-e}))}();return r.tileGrid=new f.a({extent:i,resolutions:n}),r}},{key:"createTileGrid",value:function(e,t,r,i,n){var a=Object(b.a)({extent:e,maxZoom:t,minZoom:r,tileSize:i});return new f.a({extent:e,minZoom:r,origin:n,resolutions:a.getResolutions(),tileSize:a.getTileSize()})}}]),r}(h.a),L=r(325),P=r(346),j=r(370),F=(r(40),r(68),r(485)),I=r.n(F),G=new P.b({code:"baidu",extent:[-20037726.37,-12474104.17,20037726.37,12474104.17],units:"m"});Object(P.d)(G),Object(P.c)("EPSG:4326",G,I.a.ll2bmerc,I.a.bmerc2ll),Object(P.c)("EPSG:3857",G,I.a.smerc2bmerc,I.a.bmerc2smerc);for(var M=new Array(19),U=0;U<19;++U)M[U]=Math.pow(2,18-U);var D=function(e){return new a.a({source:new u.a({projection:"baidu",maxZoom:18,tileUrlFunction:function(t){var r=t[1],i=-t[2]-1,n=t[0];r<0&&(r="M"+-r),i<0&&(i="M"+-i);var a=Math.ceil(5*Math.random());return e.url.replace(/{x}/g,r).replace(/{y}/g,i).replace(/{z}/g,n).replace(/{n}/g,a)},tileGrid:new f.a({resolutions:M,origin:[0,0]})})})},B="http://webrd03.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}&lang=zh_cn",z="http://online{n}.map.bdimg.com/tile/?qt=vtile&x={x}&y={y}&z={z}&styles=pl&scaler=1&udt=20190718",N="http://10.8.6.103/PGIS_S_TileMapServer/Maps/BJSL/EzMap?Service=getImage&Type=RGB&ZoomOffset=0",V="http://53.1.238.17/iserver/services/map-pgisvec/rest/maps/pgisvecv1",X="http://68.26.21.71/images/GetImage.do?method=showImageRedisBytable&jinyi_admin:MA_PGISSLDT&version=v1";function k(){for(var e=[],t=0;t<20;t++){var r=t<7?[64,64]:[107.5,28];e.push(r)}return e}function H(){for(var e=[],t=0;t<20;t++){var r=2.0000081722216954/Math.pow(2,t);e.push(r)}return e}function W(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"EPSG:4326",t=256,r=Object(P.i)(e),i=r.getExtent(),n=Object(L.E)(i)/t,a=[],o=[],s=0;s<=20;s++)a[s]=s,o[s]=n/Math.pow(2,s);return new l.b({origin:Object(L.C)(i),resolutions:o,matrixIds:a})}function Y(e){var t=e.layers.map((function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vec_c";return new a.a({source:new u.a({url:"http://t{0-7}.tianditu.com/DataServer?T="+e+"&x={x}&y={y}&l={z}&tk=464554f64aa4f4e90e0321c17a57a331"})})}(e)}));return new o.a({layers:t})}function Z(e){var t=W(),r=e.url;return new a.a({source:new c.a({url:r,tileGrid:t}),wrapX:!1})}function $(e){var t=e.url,r=W();return new a.a({source:new c.a({url:"",crossOrigin:"Anonymous",tileGrid:r,tileLoadFunction:function(e,r){var i=Object(j.c)(r),n={Row:i.TileRow,Col:i.TileCol,Zoom:i.TileMatrix,V:"1.0.0"};e.getImage().src="".concat(t,"&").concat(Object(j.d)(n))}}),wrapX:!1})}function q(e){if("function"==typeof e.url){var t=e.url,r=W();return new a.a({source:new c.a({url:"",crossOrigin:"Anonymous",tileGrid:r,tileLoadFunction:function(e,r){var i=Object(j.c)(r);e.getImage().src=t(i)}}),wrapX:!1})}return $(e)}function K(e){return new a.a({source:new C({url:e.url}),projection:e.projection||"EPSG:4326"})}function J(e){var t=e.url;return new a.a({projection:e.projection||"EPSG:4326",url:"".concat(t,"&l={z}&x={y}&y={x}"),tileGrid:new f.a({origin:e.origins||k(),resolutions:e.resolutions||H()})})}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof e)return e({TileLayer:a.a,LayerGroup:o.a,OSM:s.a,XYZ:u.a,WMTS:c.a,TileImage:h.a,TileGrid:f.a,WMTSGrid:l.b,getWidth:L.E,getTopLeft:L.C,getProj:P.i});var r="object"===Object(n.a)(e)?Object(i.a)({},e):{type:e},d=r.type;switch(delete r.type,d){case"OSM":return new a.a(Object(i.a)(Object(i.a)({},t),{},{source:new s.a(r)}));case"XYZ":return new a.a(Object(i.a)(Object(i.a)({},t),{},{source:new u.a(r)}));case"Amap":return new a.a(Object(i.a)(Object(i.a)({},t),{},{source:new u.a(Object(i.a)({url:B},r))}));case"Baidu":return D(Object(i.a)({url:z},r));case"TDT":return Y(Object(i.a)({layers:["vec_c","vec_w","cva_w","ibo_w"]},r));case"Founder":return Z(Object(i.a)({url:"http://127.0.0.1:3000/proxy"},r));case"Ez":return $(Object(i.a)({url:N},r));case"Super":return K(Object(i.a)({url:V},r));case"Fc":return J(Object(i.a)({url:X},r));case"WMTS":return q(r)}}},398:function(e,t,r){},400:function(e,t,r){"use strict";var i=r(296),n=(r(162),r(19),r(359),r(91),r(160),r(67),r(301),r(401),r(341),r(92),r(295)),a=r(69),o=r(486),s=r(479),u=r(473),c=r(474),h=r(426),f=r(470),l=r(464),d=r(396),p=r(316),m={name:"MyMap",provide:function(){return{myMap:this}},props:{zoom:{type:Number,default:10},minZoom:{type:Number,default:1},maxZoom:{type:Number,default:20},center:{type:Array,default:function(){return[113.261999,23.130592]}},adapter:{type:[String,Object,Function],default:"Baidu"},projection:{type:String,default:"EPSG:4326"},width:{type:String,default:"100%"},height:{type:String,default:"400px"},dragPan:{type:Boolean,default:!0},mouseWheelZoom:{type:Boolean,default:!0},mapOptions:Object,viewOptions:Object,invert:Boolean,filter:Object},render:function(){var e=arguments[0];return e("div",{class:this.classes,style:this.styles},[this.$slots.default])},data:function(){return{cursor:null,viewWidth:0,viewHeight:0}},computed:{classes:function(){return{"my-map":!0,"my-map--invert":this.invert}},styles:function(){return{width:this.width,height:this.height,cursor:this.cursor?"pointer":""}},filterStyle:function(){return this.filter?Object.entries(this.filter).map((function(e){var t=Object(a.a)(e,2),r=t[0],i=t[1];return"hue-rotate"===r?"".concat(r,"(").concat(i,"deg)"):"".concat(r,"(").concat(i,")")})).join(" "):null}},watch:{dragPan:function(e){this.setActive(u.a,e)},mouseWheelZoom:function(e){this.setActive(c.a,e)},filterStyle:function(){this.setCanvasFilter()}},methods:{setActive:function(e,t){if(this.map){var r=this.map.getInteractions().getArray().find((function(t){return t instanceof e}));r&&r.setActive(t)}},init:function(){var e=this.$props,t=e.center,r=e.projection,i=e.zoom,a=e.minZoom,f=e.maxZoom,l=Object(d.a)(this.adapter);l.__MY_LAYER__=!0;var m=new s.a(Object(n.a)(Object(n.a)({},this.viewOptions||{}),{},{projection:r,center:t,zoom:i,minZoom:a,maxZoom:f}));this.map=new o.a(Object(n.a)(Object(n.a)({},this.mapOptions||{}),{},{layers:[].concat(l),view:m,target:this.$el,controls:[],interactions:[new u.a,new c.a,new h.b({handleEvent:this.handleEvent})]})),this.setActive(u.a,this.dragPan),this.setActive(c.a,this.mouseWheelZoom),this.bindMapEvents(),this.$emit("ready",this.map,this),Object(p.addResizeListener)(this.$el,this.setViewSize),this.setCanvasFilter()},dispose:function(){this.map&&(this.map.disposeInternal(),this.unbindMapEvents(),Object(p.removeResizeListener)(this.$el,this.setViewSize))},getFeatureAtPixel:function(e){return this.map?this.map.forEachFeatureAtPixel(e,(function(e){return e})):null},setCursor:function(e){var t=this.getFeatureVM(e);this.cursor=t&&(t.cursor||t.$listeners.click)},clickTrigger:function(e,t){if(e){var r=this.getFeatureVM(e);r&&r.$emit("click",t,e)}},getLayer:function(){return this.map?this.map.getLayers().getArray().find((function(e){return e.__MY_LAYER__})):null},getFeatureVM:function(e){if(e){var t=(e.get("features")||[])[0]||e;return t.__vm__||t.get("__vm__")}},enterAndLeaveTrigger:function(e,t){if(!this.featureAtPixel&&e){this.$emit("mouseenter",t,e);var r=this.getFeatureVM(e);r&&r.$emit("mouseenter",t,e)}if(this.featureAtPixel&&!e){this.$emit("mouseleave",t,this.featureAtPixel);var i=this.getFeatureVM(this.featureAtPixel);i&&i.$emit("mouseleave",t,this.featureAtPixel)}if(this.featureAtPixel&&e&&this.featureAtPixel!==e){this.$emit("mouseleave",t,this.featureAtPixel),this.$emit("mouseenter",t,e);var n=this.getFeatureVM(this.featureAtPixel);n&&n.$emit("mouseleave",t,this.featureAtPixel);var a=this.getFeatureVM(e);a&&a.$emit("mouseenter",t,e)}this.featureAtPixel=e},handleEvent:function(e){var t=e.type,r=this.getFeatureAtPixel(e.pixel);switch(t){case"pointermove":this.setCursor(r),this.enterAndLeaveTrigger(r,e);break;case"click":this.clickTrigger(r,e)}return!0},bindMapEvents:function(){var e=this;this.map&&(Object.entries(this.$listeners).forEach((function(t){var r=Object(a.a)(t,2),i=r[0],n=r[1];return e.map.on(i,n)})),this.map.on())},unbindMapEvents:function(){var e=this;this.map&&Object.entries(this.$listeners).forEach((function(t){var r=Object(a.a)(t,2),i=r[0],n=r[1];return e.map.un(i,n)}))},resize:function(){this.map.updateSize()},moveTo:function(e){this.map&&this.map.getView().animate({center:e,duration:200})},zoomTo:function(e){this.map&&this.map.getView().animate({zoom:Number.parseInt(e),duration:200})},zoomIn:function(){if(this.map){var e=this.map.getView();this.zoomTo(e.getZoom()+1)}},zoomOut:function(){if(this.map){var e=this.map.getView();this.zoomTo(e.getZoom()-1)}},mapReady:function(e){this.map?e&&e(this.map,this):this.$once("ready",e)},createVectorLayer:function(){if(this.map&&!this.vectorLayer){var e=new l.a;return this.vectorLayer=new f.a({source:e,zIndex:1}),this.map.addLayer(this.vectorLayer),this.vectorLayer}},addFeature:function(e){if(this.map){this.vectorLayer||this.createVectorLayer();var t=this.vectorLayer.getSource(),r=[].concat(e);t.addFeatures(r)}},removeFeature:function(e){if(this.vectorLayer){var t=this.vectorLayer.getSource();[].concat(e).forEach((function(e){return t.removeFeature(e)}))}},getMetersPerUnit:function(){return this.map?this.map.getView().getProjection().getMetersPerUnit():0},setViewSize:function(){var e=this.$el.getBoundingClientRect();this.viewWidth=e.width||0,this.viewHeight=e.height||0,this.map&&this.map.updateSize(),this.$emit("viewSizeChange",e)},setCanvasFilter:function(){if(this.map){var e=this.map.getViewport();e&&(e.style.filter=this.filterStyle)}}},mounted:function(){this.init()},beforeDestroy:function(){this.dispose()}};r(483),r(398),t.a=Object(i.a)(m)},425:function(e,t,r){"use strict";var i,n=r(428),a=r(433),o=r(406),s=r(440),u=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(t){var r=e.call(this)||this;if(r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,r.addEventListener(Object(s.b)(r.geometryName_),r.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){var i=t;r.setGeometry(i)}else{var n=t;r.setProperties(n)}return r}return u(t,e),t.prototype.clone=function(){var e=new t(this.getProperties());e.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&e.setGeometry(r.clone());var i=this.getStyle();return i&&e.setStyle(i),e},t.prototype.getGeometry=function(){return this.get(this.geometryName_)},t.prototype.getId=function(){return this.id_},t.prototype.getGeometryName=function(){return this.geometryName_},t.prototype.getStyle=function(){return this.style_},t.prototype.getStyleFunction=function(){return this.styleFunction_},t.prototype.handleGeometryChange_=function(){this.changed()},t.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Object(a.c)(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=Object(a.a)(e,o.a.CHANGE,this.handleGeometryChange_,this)),this.changed()},t.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},t.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?function(e){if("function"==typeof e)return e;var t;Array.isArray(e)?t=e:(Object(n.a)("function"==typeof e.getZIndex,41),t=[e]);return function(){return t}}(e):void 0,this.changed()},t.prototype.setId=function(e){this.id_=e,this.changed()},t.prototype.setGeometryName=function(e){this.removeEventListener(Object(s.b)(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=e,this.addEventListener(Object(s.b)(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},t}(s.a);t.a=c}}]);